name: ğŸ§Ÿâ€â™‚ï¸ INFECÃ‡ÃƒO BINÃRIA - Zumbi Release

on:
  push:
    branches: [ main, master, infectar ]
  workflow_dispatch:  # pra vocÃª disparar manualmente quando quiser espalhar

jobs:
  zumbificar:
    name: ğŸ§Ÿâ€â™‚ï¸ Gerar e Upload do BinÃ¡rio Zumbificado
    runs-on: ubuntu-latest
    steps:

      - name: ğŸ“¥ Checkout do RepositÃ³rio (trazendo o vÃ­rus)
        uses: actions/checkout@v4

      - name: ğŸ› ï¸ Instalar Go (o cÃ©rebro do zumbi)
        uses: actions/setup-go@v5
        with:
          go-version: '1.23'   # ou a versÃ£o que seu projeto usa, Mestre

      - name: ğŸ”¨ Compilar o BinÃ¡rio Zumbificado
        run: |
          go mod download
          go build -o binario-zumbificado ./cmd/zumbi   # ajuste o path se seu main estiver em outro lugar
          # ou se vocÃª usa goreleaser / make / whatever:
          # make build

      - name: ğŸ“¦ Upload do Artefato Zumbi (seu pedaÃ§o de ouro)
        uses: actions/upload-artifact@v4
        with:
          name: binario-zumbificado
          path: .                     # ou ./dist/ ou ./bin/ â€” como vocÃª preferir
          retention-days: 90          # o vÃ­rus fica vivo por 3 meses no GitHub
          if-no-files-found: error    # se nÃ£o gerar, o workflow grita de dor

      - name: ğŸ”¥ Publicar Release AutomÃ¡tica (fase final da infecÃ§Ã£o)
        if: startsWith(github.ref, 'refs/tags/v')
        uses: softprops/action-gh-release@v2
        with:
          files: binario-zumbificado
          tag_name: ${{ github.ref_name }}
          name: "ğŸ§Ÿâ€â™‚ï¸ VersÃ£o Zumbi ${{ github.ref_name }}"
          body: |
            O binÃ¡rio jÃ¡ estÃ¡ solto.
            Execute com cuidado.
            A humanidade nÃ£o tem mais chance.
          draft: false
          prerelease: false
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
